<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#000000"><title>🖥️ Docker Host | Wiki - Gruppe Adler</title><meta name="description" content="Hier dokumentieren wir alles, was keiner liest, aber nicht verloren gehen soll. Unter anderem findest du Anleitung zu Missionsbau, Taktik und Infrastruktur.">
    <link rel="preload" href="/assets/js/runtime~app.237fcb94.js" as="script"><link rel="preload" href="/assets/css/styles.dcf0d6ba.css" as="style"><link rel="preload" href="/assets/js/688.36a52383.js" as="script"><link rel="preload" href="/assets/js/app.6b8b9fdd.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.dcf0d6ba.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Wiki - Gruppe Adler</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/bastelstube/" class="nav-link" aria-label="Bastelstube"><!--[--><!--]--> Bastelstube <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/infrastruktur/" class="nav-link router-link-active" aria-label="Infrastruktur"><!--[--><!--]--> Infrastruktur <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/organisatorisches/" class="nav-link" aria-label="Organisatorisches"><!--[--><!--]--> Organisatorisches <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/taktik/" class="nav-link" aria-label="Taktik"><!--[--><!--]--> Taktik <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/gruppe-adler/wiki.gruppe-adler.de" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/bastelstube/" class="nav-link" aria-label="Bastelstube"><!--[--><!--]--> Bastelstube <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/infrastruktur/" class="nav-link router-link-active" aria-label="Infrastruktur"><!--[--><!--]--> Infrastruktur <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/organisatorisches/" class="nav-link" aria-label="Organisatorisches"><!--[--><!--]--> Organisatorisches <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/taktik/" class="nav-link" aria-label="Taktik"><!--[--><!--]--> Taktik <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/gruppe-adler/wiki.gruppe-adler.de" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Infrastruktur</p><ul class=""><li><!--[--><a href="/infrastruktur/" class="nav-link router-link-active sidebar-item" aria-label="❔ Einleitung"><!--[--><!--]--> ❔ Einleitung <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="🖥️ Docker Host"><!--[--><!--]--> 🖥️ Docker Host <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html#einleitung" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Einleitung"><!--[--><!--]--> Einleitung <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html#zugriff-auf-vm" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Zugriff auf VM"><!--[--><!--]--> Zugriff auf VM <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html#die-wichtigsten-container" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Die wichtigsten Container"><!--[--><!--]--> Die wichtigsten Container <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html#docker-compose-files" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Docker Compose Files"><!--[--><!--]--> Docker Compose Files <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/infrastruktur/docker-host.html#cheat-sheet" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Cheat Sheet"><!--[--><!--]--> Cheat Sheet <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/infrastruktur/gruppe-adler-modset.html" class="nav-link sidebar-item" aria-label="📁 Gruppe Adler Modset"><!--[--><!--]--> 📁 Gruppe Adler Modset <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/infrastruktur/styleguide-design.html" class="nav-link sidebar-item" aria-label="🌈 Styleguide Design"><!--[--><!--]--> 🌈 Styleguide Design <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/infrastruktur/wiki-how-to.html" class="nav-link sidebar-item" aria-label="❓ Wiki How-To"><!--[--><!--]--> ❓ Wiki How-To <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="docker-host" tabindex="-1"><a class="header-anchor" href="#docker-host" aria-hidden="true">#</a> 🖥️ Docker Host</h1><h2 id="einleitung" tabindex="-1"><a class="header-anchor" href="#einleitung" aria-hidden="true">#</a> Einleitung</h2><p>Die Gruppe Adler verfügt über einen Dedicated Server auf welchem zwei Virtuelle Maschinen laufen. Eine dieser VMs ist der <em>Docker Host</em>, auf welchem Services wie Blechadler, Homepage, CMS, Forum, API, Slotting und einige weitere Tools als jeweils ein/mehrere Docker Container laufen.</p><h2 id="zugriff-auf-vm" tabindex="-1"><a class="header-anchor" href="#zugriff-auf-vm" aria-hidden="true">#</a> Zugriff auf VM</h2><p>Genaueres zum Zugriff gibt es <a href="https://github.com/gruppe-adler/ips-n-stuff" target="_blank" rel="noopener noreferrer">hier<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a>.</p><h2 id="die-wichtigsten-container" tabindex="-1"><a class="header-anchor" href="#die-wichtigsten-container" aria-hidden="true">#</a> Die wichtigsten Container</h2><p>Alle Applikationen (ein oder mehrere zusammenhörigen Container) sind grundsätzlich unabhängig von einander aufgebaut. Hierbei gibt es aber einige Ausnahmen:</p><h3 id="reverse-proxy" tabindex="-1"><a class="header-anchor" href="#reverse-proxy" aria-hidden="true">#</a> Reverse Proxy</h3><p>Da mehrere Applikationen von außen auf Port 80 <em>(http)</em> / 443 <em>(https)</em> erreichbar sein sollen, muss ein reverse proxy zum Einsatz kommen. Hierfür kommt <a href="https://github.com/jwilder/nginx-proxy" target="_blank" rel="noopener noreferrer">nginx-proxy<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a> und <a href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion" target="_blank" rel="noopener noreferrer">nginx-proxy-le<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a> (für das automatische Lösen von Let&#39;s Encrypt Zertifikaten) zum Einsatz.<br> Alle Container die nun auch per http(s) erreichbar sein sollen, müssen nur noch zwei Anforderungen erfüllen:</p><ol><li>Dem <code>nginx-proxy</code> Docker Netzwerk hinzugefügt sein.</li><li>Folgende Environment Variablen gesetzt haben (Hierbei natürlich <code>foo</code> durch korrekten Wert ersetzen): <ul><li><code>VIRTUAL_HOST=foo.gruppe-adler.de,www.foo.gruppe-adler.de</code></li><li><code>LETSENCRYPT_HOST=foo.gruppe-adler.de</code></li></ul></li></ol><p><img src="/assets/img/container-structure.faf355a2.svg" alt="container-structure"></p><h3 id="watchtower" tabindex="-1"><a class="header-anchor" href="#watchtower" aria-hidden="true">#</a> Watchtower</h3><p>Um die Entwicklung zu vereinfachen und ein Continuous Deployment zu gewährleisten, wird <a href="https://github.com/containrrr/watchtower" target="_blank" rel="noopener noreferrer">Watchtower<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a> eingesetzt. Dieser Container prüft periodisch ob auf Docker Hub eine neuere Versionen eines verwendeten Images zu Verfügung steht. Falls eine neue Version gefunden wurde, lädt watchtower das neue Image und updated den betroffenen Container komplett automatisch.<br> Bei uns ist es so eingestellt, dass nur Container, bei denen es explizit eingeschaltet wurde, von Watchtower geupdated werden. Dies erfolgt durch das setzen des <code>com.centurylinklabs.watchtower.enable=true</code> <a href="https://docs.docker.com/engine/reference/commandline/run/#set-metadata-on-container--l---label---label-file" target="_blank" rel="noopener noreferrer">label<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a>. Mehr dazu lässt sich in der <a href="https://containrrr.github.io/watchtower/container-selection/" target="_blank" rel="noopener noreferrer">watchtower Dokumentation<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span></a> lesen.</p><h2 id="docker-compose-files" tabindex="-1"><a class="header-anchor" href="#docker-compose-files" aria-hidden="true">#</a> Docker Compose Files</h2><p>Alle Docker Compose Konfigurationsdateien lassen sich unter <code>/etc/docker-configs/</code> finden. Der gundlegende Aufbau ist wie folgt:</p><div class="language-text ext-text"><pre class="language-text"><code>/etc/docker-configs
<span class="token punctuation">├──</span> homepage <span class="token comment">Hier befindet sich alles zur Homepage</span>
<span class="token punctuation">│</span>
<span class="token punctuation">├──</span> blechadler <span class="token comment">Hier befinden sich alles zum Blechadler</span>
<span class="token punctuation">│     ├──</span> docker-compose.yml <span class="token comment">Docker Compose Konfiguration für Blechadler</span>
<span class="token punctuation">│     └──</span> volumes <span class="token comment">Enthält soft links zu allen docker volumes für Blechadler</span>
<span class="token punctuation">│           ├── [...]</span>
<span class="token punctuation">│           └──</span> config <span class="token comment">Link zum config volume</span>
<span class="token punctuation">│</span>
<span class="token punctuation">└── [...]</span></code></pre></div><h2 id="cheat-sheet" tabindex="-1"><a class="header-anchor" href="#cheat-sheet" aria-hidden="true">#</a> Cheat Sheet</h2><h3 id="vm-neuststarten" tabindex="-1"><a class="header-anchor" href="#vm-neuststarten" aria-hidden="true">#</a> VM neuststarten</h3><p><code>reboot</code></p><h3 id="alle-container-auflisten" tabindex="-1"><a class="header-anchor" href="#alle-container-auflisten" aria-hidden="true">#</a> Alle Container auflisten</h3><p><code>docker container ls -a</code><br><img src="/assets/img/list-containers.f08d6e44.png" alt="list-containers"></p><h3 id="container-logs-einsehen" tabindex="-1"><a class="header-anchor" href="#container-logs-einsehen" aria-hidden="true">#</a> Container Logs einsehen</h3><p><code>docker logs foo</code><br><em>Hierbei natürlich foo durch den korrekten container namen ersetzten. Dieser kann in der Liste aller Container gefunden werden (siehe <a href="#alle-container-auflisten">Alle Container auflisten</a>)</em></p><h3 id="eine-applikation-neu-starten" tabindex="-1"><a class="header-anchor" href="#eine-applikation-neu-starten" aria-hidden="true">#</a> Eine Applikation (neu-)starten</h3><ol><li>In jeweilges Verzeichnis wechseln <code>cd /etc/docker-configs/foo</code></li><li>Applikation starten <code>docker-compose up -d</code></li></ol><h3 id="alle-unbenutzen-images-loschen" tabindex="-1"><a class="header-anchor" href="#alle-unbenutzen-images-loschen" aria-hidden="true">#</a> Alle unbenutzen Images löschen</h3><p><code>docker image rm $(docker image ls -q)</code><br> (Dieser Befehl versucht zwar alle Images zu löschen, kann aber Images, die aktuell in Benutzung sind nicht löschen 😅)</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/gruppe-adler/wiki.gruppe-adler.de/edit/master/docs/infrastruktur/docker-host.md" rel="noopener noreferrer" target="_blank" aria-label="Diese Seite bearbeiten"><!--[--><!--]--> Diese Seite bearbeiten <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">(öffnet in neuem Fenster)</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Zuletzt geändert: </span><span class="meta-item-info">29.9.2021, 09:22:39</span></div><div class="meta-item contributors"><span class="meta-item-label">Bearbeiter: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: DerZade@gmail.com">DerZade</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/infrastruktur/" class="nav-link router-link-active" aria-label="❔ Einleitung"><!--[--><!--]--> ❔ Einleitung <!--[--><!--]--></a></span><span class="next"><a href="/infrastruktur/gruppe-adler-modset.html" class="nav-link" aria-label="📁 Gruppe Adler Modset"><!--[--><!--]--> 📁 Gruppe Adler Modset <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script src="/assets/js/runtime~app.237fcb94.js" defer></script><script src="/assets/js/688.36a52383.js" defer></script><script src="/assets/js/app.6b8b9fdd.js" defer></script>
  </body>
</html>
